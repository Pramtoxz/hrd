import{r as d,a as m,j as e,H as E,L as C}from"./app-Bzf4dRmd.js";import{B as i}from"./createLucideIcon-tg_nj-C2.js";import{T as H,a as M,b as f,c as n,d as P,e as l}from"./table-BhYwcHBF.js";import{B as x}from"./badge-CnO_TkKf.js";import{I as z}from"./input-DrTmvRY8.js";import{D as y,a as S,b as R,c as T,d as K}from"./dialog-DGzs51EM.js";import{A as O,P as F,S as G,Z,Q as Y,a as J,T as V,C as W,b as X,D as _,E as ee,t as u}from"./app-layout-2oj67jBx.js";import{S as se}from"./sweetalert2.esm.all-NNS-RXd7.js";/* empty css            */import"./malogo-B7njwjEH.js";import"./index-DGpo2Vvf.js";import"./index-BWeyt2vI.js";import"./index-CMWG4mbA.js";import"./users-Ce7D-rrr.js";import"./loader-circle-DgWVnnky.js";import"./minus-CWnwn1Zq.js";const ae=[{title:"Dashboard",href:"/dashboard"},{title:"Aset",href:"/asets"}],L=t=>{switch(t){case"Kritis":return"destructive";case"Tinggi":return"default";case"Sedang":return"secondary";case"Rendah":return"outline";default:return"secondary"}},D=t=>{switch(t){case"Aktif":return"default";case"Maintenance":return"secondary";case"Rusak":return"destructive";case"Dihapus":return"outline";default:return"secondary"}};function ve({asets:t,filters:B}){const[j,A]=d.useState(B.search||""),[h,p]=d.useState(null),[r,v]=d.useState(null),[Q,N]=d.useState(!1);d.useEffect(()=>{const s=setTimeout(()=>{m.get("/asets",{search:j},{preserveState:!0,replace:!0})},300);return()=>clearTimeout(s)},[j]);const I=async s=>{N(!0);try{const o=await(await fetch(`/qrcode/aset/${s.id}`)).json();o.success?v({aset:s,qrCode:o.qrCode}):u.error("Gagal generate QR Code")}catch{u.error("Terjadi kesalahan saat generate QR Code")}finally{N(!1)}},$=()=>{if(!r)return;const s=r.qrCode,a=document.createElement("canvas"),o=a.getContext("2d"),g=new Image;a.width=400,a.height=400;const U=new Blob([s],{type:"image/svg+xml;charset=utf-8"}),b=URL.createObjectURL(U);g.onload=()=>{o&&(o.fillStyle="white",o.fillRect(0,0,a.width,a.height),o.drawImage(g,0,0,a.width,a.height)),a.toBlob(w=>{if(w){const k=URL.createObjectURL(w),c=document.createElement("a");c.href=k,c.download=`${r.aset.kode_aset}.png`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(k),u.success("QR Code berhasil didownload")}},"image/png"),URL.revokeObjectURL(b)},g.src=b},q=async(s,a)=>{(await se.fire({title:"Konfirmasi Hapus",text:`Apakah Anda yakin ingin menghapus aset "${a}"?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed&&m.delete(`/asets/${s}`,{onSuccess:()=>{u.success(`${a} berhasil dihapus`)},onError:()=>{u.error("Gagal menghapus aset")}})};return e.jsxs(O,{breadcrumbs:ae,children:[e.jsx(E,{title:"Aset"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Manajemen Aset"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Total: ",t.total," aset"]})]}),e.jsx(i,{asChild:!0,children:e.jsxs(C,{href:"/asets/create",children:[e.jsx(F,{className:"mr-2 h-4 w-4"}),"Tambah Data"]})})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(G,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(z,{placeholder:"Cari kode, nama, pemilik, atau lokasi...",value:j,onChange:s=>A(s.target.value),className:"pl-9"})]})}),e.jsx("div",{className:"rounded-lg border",children:e.jsxs(H,{children:[e.jsx(M,{children:e.jsxs(f,{children:[e.jsx(n,{className:"w-16",children:"No"}),e.jsx(n,{children:"Foto"}),e.jsx(n,{children:"Kode Aset"}),e.jsx(n,{children:"Nama Aset"}),e.jsx(n,{children:"Pemilik"}),e.jsx(n,{children:"Lokasi"}),e.jsx(n,{children:"Kritikalitas"}),e.jsx(n,{children:"Status"}),e.jsx(n,{className:"text-right",children:"Aksi"})]})}),e.jsx(P,{children:t.data.length>0?t.data.map((s,a)=>e.jsxs(f,{children:[e.jsx(l,{className:"font-medium",children:(t.current_page-1)*t.per_page+a+1}),e.jsx(l,{children:s.foto_aset?e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:`/assets/images/foto_aset/${s.foto_aset}`,alt:s.nama_aset,className:"h-12 w-12 object-cover rounded border cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>p({url:`/assets/images/foto_aset/${s.foto_aset}`,name:s.nama_aset})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity bg-black/50 rounded cursor-pointer",onClick:()=>p({url:`/assets/images/foto_aset/${s.foto_aset}`,name:s.nama_aset}),children:e.jsx(Z,{className:"h-5 w-5 text-white"})})]}):e.jsx("div",{className:"h-12 w-12 bg-muted rounded border flex items-center justify-center text-xs text-muted-foreground",children:"No Img"})}),e.jsx(l,{className:"font-medium",children:e.jsx("code",{className:"rounded bg-muted px-2 py-1 text-sm",children:s.kode_aset})}),e.jsx(l,{children:s.nama_aset}),e.jsx(l,{children:s.pemilik_aset||"-"}),e.jsx(l,{children:s.lokasi||"-"}),e.jsx(l,{children:e.jsx(x,{variant:L(s.kritikalitas),children:s.kritikalitas})}),e.jsx(l,{children:e.jsx(x,{variant:D(s.status),children:s.status})}),e.jsx(l,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(i,{variant:"secondary",size:"sm",onClick:()=>I(s),disabled:Q,children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx(i,{variant:"outline",size:"sm",asChild:!0,children:e.jsx(C,{href:`/asets/${s.id}/edit`,children:e.jsx(J,{className:"h-4 w-4"})})}),e.jsx(i,{variant:"destructive",size:"sm",onClick:()=>q(s.id,s.nama_aset),children:e.jsx(V,{className:"h-4 w-4"})})]})})]},s.id)):e.jsx(f,{children:e.jsx(l,{colSpan:9,className:"text-center py-8 text-muted-foreground",children:"Tidak ada data aset"})})})]})}),t.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Menampilkan ",(t.current_page-1)*t.per_page+1," - ",Math.min(t.current_page*t.per_page,t.total)," dari ",t.total," data"]}),e.jsx("div",{className:"flex gap-1",children:t.links.map((s,a)=>s.label==="&laquo; Previous"?e.jsx(i,{variant:"outline",size:"sm",disabled:!s.url,onClick:()=>s.url&&m.get(s.url,{},{preserveState:!0,preserveScroll:!0}),children:e.jsx(W,{className:"h-4 w-4"})},a):s.label==="Next &raquo;"?e.jsx(i,{variant:"outline",size:"sm",disabled:!s.url,onClick:()=>s.url&&m.get(s.url,{},{preserveState:!0,preserveScroll:!0}),children:e.jsx(X,{className:"h-4 w-4"})},a):e.jsx(i,{variant:s.active?"default":"outline",size:"sm",disabled:!s.url,onClick:()=>s.url&&m.get(s.url,{},{preserveState:!0,preserveScroll:!0}),children:s.label},a))})]})]}),e.jsx(y,{open:!!h,onOpenChange:()=>p(null),children:e.jsxs(S,{className:"max-w-3xl",children:[e.jsx(R,{children:e.jsx(T,{children:h?.name})}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("img",{src:h?.url,alt:h?.name,className:"max-h-[70vh] w-auto object-contain rounded-lg"})})]})}),e.jsx(y,{open:!!r,onOpenChange:()=>v(null),children:e.jsxs(S,{className:"max-w-2xl",children:[e.jsxs(R,{children:[e.jsxs(T,{children:["QR Code Aset - ",r?.aset.kode_aset]}),e.jsx(K,{children:"Scan QR Code untuk melihat detail lengkap aset atau download untuk membuat stiker"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center p-6 bg-muted rounded-lg",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-lg",dangerouslySetInnerHTML:{__html:r?.qrCode||""}}),e.jsx("p",{className:"mt-4 text-sm font-medium",children:r?.aset.nama_aset}),e.jsx("code",{className:"text-xs text-muted-foreground",children:r?.aset.kode_aset})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-muted rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pemilik"}),e.jsx("p",{className:"font-medium",children:r?.aset.pemilik_aset||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Lokasi"}),e.jsx("p",{className:"font-medium",children:r?.aset.lokasi||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Kritikalitas"}),e.jsx(x,{variant:L(r?.aset.kritikalitas||""),children:r?.aset.kritikalitas})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsx(x,{variant:D(r?.aset.status||""),children:r?.aset.status})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(i,{onClick:$,className:"flex-1",children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Download QR Code"]}),e.jsxs(i,{variant:"outline",onClick:()=>window.open(`/cek/qrcode/${r?.aset.id}`,"_blank"),className:"flex-1",children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Lihat Detail"]})]})]})]})})]})}export{ve as default};
