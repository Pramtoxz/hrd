import{u as P,U as x,j as e,H as C}from"./app-Cej10E3O.js";import{B as j}from"./createLucideIcon-BgVc6Hot.js";import{I as g}from"./input-DvsjLBsu.js";import{L as m}from"./label-DqlNtHPN.js";import{T as F}from"./textarea-atjTz7UU.js";import{S as R,a as B,b as T,c as D,d as O}from"./select-KyXyi2Y2.js";import{C as A}from"./checkbox-B_JFNTNr.js";import{A as I,t as _}from"./app-layout-SVK9y9af.js";import{S as M}from"./sweetalert2.esm.all-NNS-RXd7.js";import{X as W}from"./index-DdcgWVWY.js";/* empty css            */import"./index-CU3jzwCX.js";import"./index-Cix3gUUA.js";import"./index-CnQ-pfKV.js";import"./malogo-DU1dCDkW.js";import"./index-BWeyt2vI.js";import"./index-CMWG4mbA.js";import"./loader-circle-CW5OcCCs.js";import"./minus-nI1ca6Xa.js";const $=[{title:"Dashboard",href:"/dashboard"},{title:"Release",href:"/release"},{title:"Buat Release",href:"/release/create"}];function le({pressReleases:u}){const{data:r,setData:i,post:N,processing:v,errors:n}=P({judul:"",isi_berita:"",tanggal_publikasi:new Date().toISOString().split("T")[0],press_release_id:"",use_press_release_photos:!1,foto1:null,foto2:null,foto3:null,foto4:null,foto5:null}),[f,h]=x.useState({}),[d,p]=x.useState({}),[l,b]=x.useState(null),k=async s=>{if(i("press_release_id",s),s){const a=u.find(t=>t.id.toString()===s);b(a||null);try{const o=await(await fetch(`/release/press-release-photos/${s}`)).json();p(o.photos||{})}catch(t){console.error("Failed to fetch photos:",t),p({})}}else b(null),p({}),i("use_press_release_photos",!1)},w=(s,a)=>{const t=s.target.files?.[0]||null;if(i(a,t),t){const o=new FileReader;o.onloadend=()=>{h(c=>({...c,[a]:o.result}))},o.readAsDataURL(t)}else h(o=>{const c={...o};return delete c[a],c})},y=s=>{i(s,null),h(a=>{const t={...a};return delete t[s],t})},S=async s=>{s.preventDefault(),(await M.fire({title:"Konfirmasi Simpan",text:"Apakah Anda yakin ingin membuat release ini?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3b82f6",cancelButtonColor:"#6b7280",confirmButtonText:"Ya, Simpan!",cancelButtonText:"Batal"})).isConfirmed&&N("/release",{forceFormData:!0,onSuccess:()=>{_.success("Release berhasil dibuat")},onError:()=>{_.error("Gagal membuat release")}})};return e.jsxs(I,{breadcrumbs:$,children:[e.jsx(C,{title:"Form Release"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-4 p-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Form Release"}),e.jsx("div",{className:"max-w-4xl rounded-lg border p-6",children:e.jsxs("form",{onSubmit:S,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"press_release_id",children:"Sumber Press Release (Opsional)"}),e.jsxs(R,{value:r.press_release_id||void 0,onValueChange:k,children:[e.jsx(B,{children:e.jsx(T,{placeholder:"Pilih Press Release sebagai referensi (atau kosongkan untuk manual)"})}),e.jsx(D,{children:u.length>0?u.map(s=>e.jsxs(O,{value:s.id.toString(),children:[s.what," - ",s.who," (",s.when,")"]},s.id)):e.jsx("div",{className:"p-2 text-sm text-muted-foreground text-center",children:"Tidak ada Press Release yang tersedia"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pilih press release sebagai referensi untuk menulis release ini"})]}),l&&e.jsxs("div",{className:"p-4 border rounded-lg bg-muted/30 space-y-3",children:[e.jsx("h3",{className:"font-semibold text-sm",children:"Referensi Press Release:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"What:"})," ",l.what]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Who:"})," ",l.who]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"When:"})," ",l.when]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Where:"})," ",l.where]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Why:"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:l.why})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"How:"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:l.how})]}),l.pemberi_kutipan&&e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium",children:["Kutipan dari ",l.pemberi_kutipan,":"]}),e.jsxs("p",{className:"text-muted-foreground mt-1 italic",children:['"',l.isi_kutipan,'"']})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"judul",children:"Judul *"}),e.jsx(g,{id:"judul",value:r.judul,onChange:s=>i("judul",s.target.value),placeholder:"Masukkan judul release",required:!0}),n.judul&&e.jsx("p",{className:"text-sm text-red-500",children:n.judul})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"isi_berita",children:"Isi Berita *"}),e.jsx(F,{id:"isi_berita",value:r.isi_berita,onChange:s=>i("isi_berita",s.target.value),placeholder:"Tulis isi berita lengkap",rows:20,className:"min-h-[400px]",required:!0}),n.isi_berita&&e.jsx("p",{className:"text-sm text-red-500",children:n.isi_berita})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"tanggal_publikasi",children:"Tanggal Publikasi *"}),e.jsx(g,{id:"tanggal_publikasi",type:"date",value:r.tanggal_publikasi,onChange:s=>i("tanggal_publikasi",s.target.value),required:!0}),n.tanggal_publikasi&&e.jsx("p",{className:"text-sm text-red-500",children:n.tanggal_publikasi})]}),r.press_release_id&&Object.keys(d).length>0&&e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{id:"use_press_release_photos",checked:r.use_press_release_photos,onCheckedChange:s=>i("use_press_release_photos",s)}),e.jsx(m,{htmlFor:"use_press_release_photos",className:"cursor-pointer",children:"Gunakan foto dari Press Release"})]}),r.use_press_release_photos&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Foto dari Press Release (",Object.keys(d).length," foto):"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2",children:Object.entries(d).map(([s,a])=>e.jsx("img",{src:a,alt:s,className:"h-24 w-full object-cover rounded border"},s))})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(m,{children:r.use_press_release_photos?`Upload Foto Tambahan (Maksimal ${5-Object.keys(d).length} foto lagi)`:"Upload Foto (Maksimal 5)"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[1,2,3,4,5].map(s=>{const a=`foto${s}`,t=Object.keys(d).length;return r.use_press_release_photos&&s<=t?null:e.jsx("div",{className:"space-y-2",children:f[a]?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:f[a],alt:`Preview ${s}`,className:"h-32 w-full object-cover rounded-lg border"}),e.jsx(j,{type:"button",variant:"destructive",size:"sm",className:"absolute top-1 right-1",onClick:()=>y(a),children:e.jsx(W,{className:"h-3 w-3"})})]}):e.jsx("div",{className:"h-32 border-2 border-dashed rounded-lg flex items-center justify-center",children:e.jsxs("label",{htmlFor:a,className:"cursor-pointer text-center p-2",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Foto ",r.use_press_release_photos?s-t:s]}),e.jsx(g,{id:a,type:"file",accept:"image/*",onChange:c=>w(c,a),className:"hidden"})]})})},a)})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Format: JPG, PNG. Maksimal 2MB per foto",r.use_press_release_photos&&` (Sudah ada ${Object.keys(d).length} foto dari Press Release)`]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{type:"submit",disabled:v,children:"Simpan"}),e.jsx(j,{type:"button",variant:"outline",onClick:()=>window.history.back(),children:"Batal"})]})]})})]})]})}export{le as default};
